<Window x:Class="SHPDiagnosticsViewer.ProjectDataPreviewWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Project Data Preview" Height="600" Width="900"
        MinHeight="480" MinWidth="720">
  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <StackPanel Grid.Row="0" Margin="0,0,0,8">
      <TextBlock x:Name="StageText" Text="Preparing extraction..." Margin="0,0,0,6" />
      <ProgressBar x:Name="ExtractionProgressBar" Height="18" Minimum="0" Maximum="100" />
    </StackPanel>

    <TabControl Grid.Row="1">
      <TabItem Header="Diagnostics Mapping">
        <DataGrid ItemsSource="{Binding DiagnosticsMapping}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  HeadersVisibility="Column"
                  CanUserAddRows="False">
          <DataGrid.Columns>
            <DataGridTextColumn Header="DeviceId" Binding="{Binding DeviceId}" Width="80" />
            <DataGridTextColumn Header="DeviceName" Binding="{Binding DeviceName}" Width="*" />
            <DataGridTextColumn Header="RTI" Binding="{Binding RtiAddress}" Width="60" />
            <DataGridTextColumn Header="PageId" Binding="{Binding PageId}" Width="70" />
            <DataGridTextColumn Header="PageName" Binding="{Binding PageName}" Width="*" />
          </DataGrid.Columns>
        </DataGrid>
      </TabItem>

      <TabItem Header="Project Report">
        <DataGrid ItemsSource="{Binding ProjectReport}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  HeadersVisibility="Column"
                  CanUserAddRows="False">
          <DataGrid.Columns>
            <DataGridTextColumn Header="Type" Binding="{Binding EntityType}" Width="120" />
            <DataGridTextColumn Header="PrimaryId" Binding="{Binding PrimaryId}" Width="90" />
            <DataGridTextColumn Header="SecondaryId" Binding="{Binding SecondaryId}" Width="100" />
            <DataGridTextColumn Header="TertiaryId" Binding="{Binding TertiaryId}" Width="100" />
            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="*" />
            <DataGridTextColumn Header="Detail" Binding="{Binding Detail}" Width="*" />
          </DataGrid.Columns>
        </DataGrid>
      </TabItem>

      <TabItem Header="Project Test">
        <DataGrid ItemsSource="{Binding ProjectTest}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  HeadersVisibility="Column"
                  CanUserAddRows="False">
          <DataGrid.Columns>
            <DataGridTextColumn Header="DeviceId" Binding="{Binding DeviceId}" Width="80" />
            <DataGridTextColumn Header="DeviceName" Binding="{Binding DeviceName}" Width="*" />
            <DataGridTextColumn Header="SourceIdx" Binding="{Binding SourceLabelIndex}" Width="90" />
            <DataGridTextColumn Header="PageId" Binding="{Binding PageId}" Width="70" />
            <DataGridTextColumn Header="PageName" Binding="{Binding PageName}" Width="*" />
            <DataGridTextColumn Header="ButtonId" Binding="{Binding ButtonId}" Width="80" />
            <DataGridTextColumn Header="TagId" Binding="{Binding ButtonTagId}" Width="70" />
            <DataGridTextColumn Header="ButtonText" Binding="{Binding ButtonText}" Width="*" />
          </DataGrid.Columns>
        </DataGrid>
      </TabItem>
    </TabControl>

    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
      <Button Content="Close" Width="90" Click="Close_Click" />
    </StackPanel>
  </Grid>
</Window>
