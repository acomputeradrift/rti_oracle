<Window x:Class="SHPDiagnosticsViewer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="RTI Oracle by FP&amp;C Ltd." Height="720" Width="1000"
        MinHeight="480" MinWidth="720">
  <Window.Resources>
    <BooleanToVisibilityConverter x:Key="BoolToVis" />
    <Style x:Key="LevelButtonStyle" TargetType="Button">
      <Setter Property="Width" Value="28" />
      <Setter Property="Height" Value="22" />
      <Setter Property="Margin" Value="6,0,0,0" />
      <Setter Property="Padding" Value="0" />
      <Setter Property="Background" Value="#F3F3F3" />
      <Setter Property="BorderBrush" Value="#BDBDBD" />
      <Setter Property="BorderThickness" Value="1" />
    </Style>

    <Style x:Key="DriverToggleStyle" TargetType="ToggleButton">
      <Setter Property="Background" Value="#F3F3F3" />
      <Setter Property="BorderBrush" Value="#BDBDBD" />
      <Setter Property="BorderThickness" Value="1" />
      <Setter Property="Height" Value="30" />
      <Style.Triggers>
        <Trigger Property="IsChecked" Value="True">
          <Setter Property="Background" Value="#D9F2D9" />
        </Trigger>
      </Style.Triggers>
    </Style>
  </Window.Resources>
  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition x:Name="DriverLogRow" Height="Auto" />
      <RowDefinition Height="6" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>

    <Grid x:Name="TopHeaderGrid" Grid.Row="0" Grid.Column="0" Margin="0,0,0,8">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
      </Grid.RowDefinitions>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
      </Grid.ColumnDefinitions>

      <Border x:Name="ConnectBoxBorder"
              Grid.Row="0"
              Grid.RowSpan="2"
              Grid.Column="0"
              BorderBrush="#CCCCCC"
              BorderThickness="1"
              CornerRadius="4"
              Padding="8"
              HorizontalAlignment="Stretch"
              Height="{Binding ActualHeight, ElementName=ProjectDataBorder}">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
          </Grid.RowDefinitions>
          <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,6">
            <TextBlock Text="SHP IP:" VerticalAlignment="Center" Margin="0,0,8,0" />
            <ComboBox x:Name="IpComboBox" Width="220" Height="26" Margin="0,0,8,0" IsEditable="True" IsTextSearchEnabled="False" />
            <Button x:Name="ConnectButton" Content="Connect" Width="90" Height="26" Margin="0,0,8,0"
                    IsEnabled="False"
                    ToolTip="Upload a project (.apex) to enable connecting."
                    Click="ConnectButton_Click" />
            <Button x:Name="DisconnectButton" Content="Disconnect" Width="90" Height="26" IsEnabled="False" Click="DisconnectButton_Click" />
            <TextBlock x:Name="StatusText" Text="Idle" VerticalAlignment="Center" Margin="12,0,0,0" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Grid.Row="1">
            <Button x:Name="DiscoverButton" Content="Discover" Width="90" Height="26" Margin="0,0,8,0" Click="DiscoverButton_Click" />
            <TextBlock Text="Discovered:" VerticalAlignment="Center" Margin="0,0,8,0" />
            <ComboBox x:Name="DiscoveredCombo" Width="260" Height="26" SelectionChanged="DiscoveredCombo_SelectionChanged" />
          </StackPanel>
        </Grid>
      </Border>

      <Image x:Name="AppLogoImage"
             Grid.Row="0"
             Grid.RowSpan="2"
             Grid.Column="1"
             Source="pack://application:,,,/feeny-logo-100-circle-black-back.png"
             Width="{Binding ActualHeight, ElementName=ProjectDataBorder}"
             Height="{Binding ActualHeight, ElementName=ProjectDataBorder}"
             Margin="12,0"
             VerticalAlignment="Center"
             HorizontalAlignment="Center"
             Stretch="Uniform" />

      <Border x:Name="ProjectDataBorder"
              Grid.Row="0"
              Grid.RowSpan="2"
              Grid.Column="2"
              BorderBrush="#CCCCCC"
              BorderThickness="1"
              CornerRadius="4"
              Padding="8"
              HorizontalAlignment="Stretch"
              VerticalAlignment="Top"
              Width="{Binding ActualWidth, ElementName=ConnectBoxBorder}">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
          </Grid.RowDefinitions>
          <TextBlock x:Name="ProjectDataHeaderText" Text="Project Data" FontWeight="SemiBold" Margin="0,0,0,8" />
          <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,6">
            <Button x:Name="UploadProjectButton" Content="Upload Project (.apex)" Width="180" Height="28" Click="UploadProject_Click" />
            <TextBlock x:Name="ProjectFileNameText" Text="No project selected" VerticalAlignment="Center" Margin="10,0,0,0" TextTrimming="CharacterEllipsis" />
          </StackPanel>
          <StackPanel Grid.Row="2" Orientation="Horizontal">
            <Button x:Name="UploadAdditionalInfoButton" Content="Upload Additional Info (.xlsx)" Width="180" Height="28" />
            <TextBlock x:Name="AdditionalInfoFileNameText" Text="No additional info" VerticalAlignment="Center" Margin="10,0,0,0" TextTrimming="CharacterEllipsis" />
          </StackPanel>
        </Grid>
      </Border>
    </Grid>

    <Border Grid.Row="1" Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4" Padding="6" Margin="0,0,0,0">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto" />
          <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <ToggleButton x:Name="DriverLogLevelsToggleButton"
                      Content="Driver Log Levels â–¾"
                      FontWeight="SemiBold"
                      IsChecked="False"
                      Checked="DriverLogLevelsToggleButton_Checked"
                      Unchecked="DriverLogLevelsToggleButton_Unchecked"
                      Margin="0,0,0,6" />
        <Grid Grid.Row="1"
              Visibility="{Binding IsChecked, ElementName=DriverLogLevelsToggleButton, Converter={StaticResource BoolToVis}}">
          <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                        VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding Drivers}">
              <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                  <UniformGrid Columns="4" />
                </ItemsPanelTemplate>
              </ItemsControl.ItemsPanel>
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Grid Height="30" Margin="0,0,8,8">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*" />
                      <ColumnDefinition Width="Auto" />
                      <ColumnDefinition Width="Auto" />
                      <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <ToggleButton Grid.Column="0" Content="{Binding Name}" Margin="0,0,4,0"
                                  IsChecked="{Binding IsEnabled, Mode=TwoWay}" Click="DriverToggle_Click"
                                  Style="{StaticResource DriverToggleStyle}" />
                    <Button Grid.Column="1" Content="1" Tag="1" Click="DriverLevelButton_Click">
                      <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource LevelButtonStyle}">
                          <Style.Triggers>
                            <MultiDataTrigger>
                              <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding IsEnabled}" Value="True" />
                                <Condition Binding="{Binding SelectedLevel}" Value="1" />
                              </MultiDataTrigger.Conditions>
                              <Setter Property="Background" Value="#DDEBFF" />
                            </MultiDataTrigger>
                          </Style.Triggers>
                        </Style>
                      </Button.Style>
                    </Button>
                    <Button Grid.Column="2" Content="2" Tag="2" Click="DriverLevelButton_Click">
                      <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource LevelButtonStyle}">
                          <Style.Triggers>
                            <MultiDataTrigger>
                              <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding IsEnabled}" Value="True" />
                                <Condition Binding="{Binding SelectedLevel}" Value="2" />
                              </MultiDataTrigger.Conditions>
                              <Setter Property="Background" Value="#DDEBFF" />
                            </MultiDataTrigger>
                          </Style.Triggers>
                        </Style>
                      </Button.Style>
                    </Button>
                    <Button Grid.Column="3" Content="3" Tag="3" Click="DriverLevelButton_Click">
                      <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource LevelButtonStyle}">
                          <Style.Triggers>
                            <MultiDataTrigger>
                              <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding IsEnabled}" Value="True" />
                                <Condition Binding="{Binding SelectedLevel}" Value="3" />
                              </MultiDataTrigger.Conditions>
                              <Setter Property="Background" Value="#DDEBFF" />
                            </MultiDataTrigger>
                          </Style.Triggers>
                        </Style>
                      </Button.Style>
                    </Button>
                  </Grid>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </ScrollViewer>
        </Grid>
      </Grid>
    </Border>

    <GridSplitter x:Name="DriverLogSplitter"
                  Grid.Row="2"
                  Grid.Column="0"
                  Height="6"
                  HorizontalAlignment="Stretch"
                  VerticalAlignment="Stretch"
                  Background="Transparent"
                  Opacity="0"
                  Cursor="SizeNS"
                  ResizeDirection="Rows"
                  ResizeBehavior="PreviousAndNext"
                  Visibility="Collapsed"
                  Panel.ZIndex="2" />

    <Border Grid.Row="3" Grid.Column="0" BorderBrush="#CCCCCC" BorderThickness="1" CornerRadius="4" Padding="6" Margin="0,0,0,0">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto" />
          <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid Margin="0,0,0,6">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
          </Grid.ColumnDefinitions>
          <TextBlock Text="Diagnostics" FontWeight="SemiBold" VerticalAlignment="Center" Margin="0,0,12,0" />
          <Grid Grid.Column="1" HorizontalAlignment="Center">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="180" />
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="150" />
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="150" />
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="Auto" />
              <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="Filter: Keyword" VerticalAlignment="Center" Margin="0,0,6,0" />
            <TextBox x:Name="FilterKeywordTextBox" Grid.Column="1" Width="176" Height="24" Margin="0,0,16,0" />
            <TextBlock Grid.Column="2" Text="Start:" VerticalAlignment="Center" Margin="0,0,6,0" />
            <TextBox x:Name="FilterStartTextBox" Grid.Column="3" Height="24" Margin="0,0,12,0" />
            <TextBlock Grid.Column="4" Text="End:" VerticalAlignment="Center" Margin="0,0,6,0" />
            <TextBox x:Name="FilterEndTextBox" Grid.Column="5" Height="24" Margin="0,0,12,0" />
            <Button x:Name="FilterApplyButton" Grid.Column="6" Content="Filter" Padding="8,2" Margin="0,0,8,0" />
            <Button x:Name="FilterClearButton" Grid.Column="7" Content="Clear" Padding="8,2" Margin="0,0,8,0" />
            <TextBlock x:Name="FilterCountText" Grid.Column="8" Text="Count: 0" VerticalAlignment="Center" />
          </Grid>
          <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
            <Button x:Name="DownloadLogsButton"
                    Content="Download Logs"
                    Padding="10,2"
                    Margin="0,0,8,0" />
            <Button Content="Clear"
                    Padding="10,2"
                    Click="ClearDiagnostics_Click" />
          </StackPanel>
        </Grid>
          <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*" />
            <ColumnDefinition Width="8" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

          <Border Grid.Column="0" BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="3" Padding="6">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
              </Grid.RowDefinitions>
              <Grid Margin="0,0,0,6">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="Raw Output" FontWeight="SemiBold" VerticalAlignment="Center" />
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                  <TextBlock Text="Find:" VerticalAlignment="Center" Margin="0,0,6,0" />
                  <TextBox x:Name="RawFindTextBox" Width="140" Height="24" Margin="0,0,8,0" />
                  <Button x:Name="RawFindPrevButton" Content="Prev" Padding="6,2" Margin="0,0,4,0" />
                  <Button x:Name="RawFindNextButton" Content="Next" Padding="6,2" Margin="0,0,4,0" />
                  <Button x:Name="RawFindClearButton" Content="Clear" Padding="6,2" Margin="0,0,8,0" />
                  <TextBlock x:Name="RawFindCountText" Text="Count: 0" VerticalAlignment="Center" />
                </StackPanel>
              </Grid>
              <TextBox x:Name="RawLogTextBox"
                       Grid.Row="1"
                       FontFamily="Consolas"
                       FontSize="12"
                       IsReadOnly="True"
                       TextWrapping="NoWrap"
                       Padding="0"
                       VerticalScrollBarVisibility="Auto"
                       HorizontalScrollBarVisibility="Auto"
                       AcceptsReturn="True" />
            </Grid>
          </Border>

          <GridSplitter Grid.Column="1"
                        Width="8"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        Background="Transparent"
                        Opacity="0"
                        Cursor="SizeWE"
                        ShowsPreview="False" />

          <Border Grid.Column="2" BorderBrush="#DDDDDD" BorderThickness="1" CornerRadius="3" Padding="6">
            <Grid>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
              </Grid.RowDefinitions>
              <Grid Margin="0,0,0,6">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="Processed Output" FontWeight="SemiBold" VerticalAlignment="Center" />
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                  <TextBlock Text="Find:" VerticalAlignment="Center" Margin="0,0,6,0" />
                  <TextBox x:Name="ProcessedFindTextBox" Width="140" Height="24" Margin="0,0,8,0" />
                  <Button x:Name="ProcessedFindPrevButton" Content="Prev" Padding="6,2" Margin="0,0,4,0" />
                  <Button x:Name="ProcessedFindNextButton" Content="Next" Padding="6,2" Margin="0,0,4,0" />
                  <Button x:Name="ProcessedFindClearButton" Content="Clear" Padding="6,2" Margin="0,0,8,0" />
                  <TextBlock x:Name="ProcessedFindCountText" Text="Count: 0" VerticalAlignment="Center" />
                </StackPanel>
              </Grid>
              <RichTextBox x:Name="ProcessedLogTextBox"
                       Grid.Row="1"
                       FontFamily="Consolas"
                       FontSize="12"
                       IsReadOnly="True"
                       Background="Black"
                       Foreground="White"
                       VerticalScrollBarVisibility="Auto"
                       HorizontalScrollBarVisibility="Auto"
                       AcceptsReturn="True">
                <FlowDocument>
                  <Paragraph>No processed information available</Paragraph>
                </FlowDocument>
              </RichTextBox>
            </Grid>
          </Border>
        </Grid>
      </Grid>
    </Border>

    <StackPanel Grid.Row="3" Grid.Column="0" Visibility="Collapsed">
      <CheckBox x:Name="TcpCaptureCheckBox" Content="TCP Capture (RAW)" />
      <CheckBox x:Name="SendProbeCheckBox" Content="Send probe on connect (diagnostic)" />
    </StackPanel>
  </Grid>
</Window>
